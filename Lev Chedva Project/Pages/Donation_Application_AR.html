<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../styles/Donation_style_HE.css">
  <link rel="stylesheet" type="text/css" href="../styles/logo_footer.css">
  <title>استمارة التبرع بمعدات طبية</title>
</head>
<body>
  <div class="content-wrapper">
    <div class="logo-container">
      <a href="../Pages/MainPage/index_AR.html">
        <img src="../Pictures/logoLevChedva.png" alt="Logo" />
      </a>
    </div>
    <form>
      <h1>استمارة التبرع بمعدات طبية</h1>
      <label for="name">الاسم الكامل:</label>
      <input type="text" id="name" name="name"><br><br>
      
      <label for="Phone Number">: رقم هاتف الاتصال</label>
      <input type="tel" id="Phone Number" name="Phone Number"><br><br>
      
      <label for="Phone Number2">: هاتف آخر</label>
      <input type="tel" id="Phone Number2" name="Phone Number2"><br><br>

      <label for="Product">: التبرع بالمعدات</label>
      <input type="text" id="Product" name="Product"><br><br>
      
      <input type="button" value="يرسل" onclick="submitData()">
    </form>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="../firebase.js"></script>
    <script src="../Scripts/auth.js"></script>
    <script>
      const db = firebase.firestore();
      // Get form elements
      const nameInput = document.getElementById("name");
      const Phone_NumInput = document.getElementById("Phone Number");
      const Phone_NumInput2 = document.getElementById("Phone Number2");
      const ProductInput = document.getElementById("Product");

      // Function to submit form data to Firestore
      function submitData() {
      //  if (validateForm()) {
          // Get the values from the form
          const name = nameInput.value;
          const Phone_Num = Phone_NumInput.value;
          const Phone_Num2 = Phone_NumInput2.value;
          const Product = ProductInput.value;

          // Save the data to Firestore
          db.collection("Donation_List").add({
            name: name,
            Phone_Num: Phone_Num,
            Phone_Num2: Phone_Num2, // Corrected variable name
            Product: Product,
            date: firebase.firestore.Timestamp.fromDate(new Date()), // Current date and time
          })
          .then((docRef) => {
            alert("!تم ارسال طلبك بنجاح");
            // Clear form fields
            window.location.href = "../Pages/MainPage/index.html";
          })
          .catch((error) => {
            console.error("Error adding document: ", error);
            alert("خطأ");
          });
        
      }

      function validateForm() {
        let isValid = true;
        const nameRegex = /^[a-zA-Zא-ת ,'"\-]*$/;
        const phoneRegex = /^[0-9+-]{9,14}$/;

        const contactName = document.getElementById("name"); // Corrected ID
        const contactNameError = document.getElementById("contact-name-error"); // Added ID
        if (!contactName.value || !nameRegex.test(contactName.value)) {
            contactName.style.border = '2px solid red';
            contactNameError.textContent = 'اسم غير صحيح';
            isValid = false;
        } else {
            contactName.style.border = '';
            contactNameError.textContent = '';
        }

        const contactNumber = document.getElementById("Phone Number"); // Corrected ID
        const contactNumberError = document.getElementById("contact-number-error"); // Added ID
        if (!contactNumber.value || !phoneRegex.test(contactNumber.value)) {
            contactNumber.style.border = '2px solid red';
            contactNumberError.textContent = 'رقم هاتف غير صحيح';
            isValid = false;
        } else {
            contactNumber.style.border = '';
            contactNumberError.textContent = '';
        }

        const contactNumber2 = document.getElementById("Phone Number2"); // Corrected ID
        const contactNumber2Error = document.getElementById("contact-number2-error"); // Added ID
        if (!contactNumber2.value || !phoneRegex.test(contactNumber2.value)) {
            contactNumber2.style.border = '2px solid red';
            contactNumber2Error.textContent = 'رقم هاتف غير صحيح';
            isValid = false;
        } else {
            contactNumber2.style.border = '';
            contactNumber2Error.textContent = '';
        }

        const patientName = document.getElementById("Product"); // Corrected ID
        const patientNameError = document.getElementById("patient-name-error"); // Added ID
        if (patientName.value && !nameRegex.test(patientName.value)) {
            patientName.style.border = '2px solid red';
            patientNameError.textContent = 'اسم غير صحيح';
            isValid = false;
        } else {
            patientName.style.border = '';
            patientNameError.textContent = '';
        }

        return isValid;
      }
    </script>
  </div>
  <footer>
    <p class="copyright">
      &copy; 2023 LevChedva. All rights reserved.
    </p>
  </footer>
</body>
</html>
